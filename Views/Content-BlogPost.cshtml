@using Orchard.ContentManagement;
@using Orchard.MediaLibrary.Fields
@using Orchard.MediaLibrary.Models
@using Orchard.Tags.ViewModels;

@{
    Script.Require("Sharrre");
    var blogPost = Model.ContentItem;
    var imageField = blogPost.BlogPostPart.BlogPostMedia as MediaLibraryPickerField;
    var documentField = blogPost.BlogPostPart.BlogPostDownloads as MediaLibraryPickerField;
}

<div class="ui--blog ui--blog-wrapper ui--pass">
    <div class="ui--blog-item clearfix layout--single">
        @if (imageField != null) {
            if (imageField.MediaParts.Count() > 1) {
                <div class="ui--blog-media">
                    <div class="ui--blog-gallery" data-options="{'effect':'fade','auto_rotate':false,'rotate_time':false}">
                        <div class="slides">
                            @foreach (var mediapart in imageField.MediaParts) {
                                if (mediapart.MimeType.StartsWith("image")) {
                                    <div class="ui--blog-gallery-item">
                                        <img class="ui--blog-gallery-image" src="@mediapart.MediaUrl" alt="@mediapart.AlternateText" />
                                    </div>
                                }
                            }
                        </div>
                        <div class="ui--blog-gallery-navigation"></div>
                    </div>
                </div>
            }
            else if (imageField.MediaParts.Count() == 1) {
                <div class="ui--blog-media">
                    @foreach (var mediapart in imageField.MediaParts) {
                        if (mediapart.MimeType.StartsWith("image")) {
                            <a class="ui--blog-link" href="#">
                                <img class="ui--blog-image" src="@mediapart.MediaUrl" alt="@mediapart.AlternateText">
                            </a>
                        }
                        else if (mediapart.MimeType.StartsWith("video")) {
                            <div class="ui--blog-video clearfix">
                                <div class="ui--video-wrapper clearfix">
                                    <div class="ui--video ui--video-16-9">
                                        <iframe src="@mediapart.MediaUrl"></iframe>
                                    </div>
                                </div>
                            </div>
                        }
                        else if (mediapart.MimeType == "text/html") {
                            <div class="ui--blog-video clearfix">
                                <div class="ui--video-wrapper clearfix">
                                    <div class="ui--video ui--video-16-9">
                                        @Html.Raw(mediapart.As<OEmbedPart>()["html"])
                                    </div>
                                </div>
                            </div>
                        }
                    }
                </div>
            }
        }
        <div class="ui--blog-content-wrapper">
            <div class="ui--blog-header">
                <h3 class="ui--blog-title entry-title clearfix"><span class="ui--blog-link">@blogPost.TitlePart.Title</span></h3>
            </div>
            <div class="ui--blog-content">
                @Display(Model.Summary)

                @if (documentField != null) {
                    <div class="ui--blog-documents">
                        <ul>
                            @foreach (var mediapart in documentField.MediaParts) {
                                <li class="@(mediapart.FileName.ToLower().EndsWith("pdf") ? "pdf" : "doc")">
                                    <a href="@mediapart.MediaUrl" target="_blank">@mediapart.AlternateText</a>
                                </li>
                            }
                        </ul>
                    </div>
                }
            </div>
            <div class="ui--blog-metas clearfix">
                <span>
                    <span class="ui--blog-metas-left">
                        <span class="datetime"><time class="entry-date date updated" datetime="@blogPost.CommonPart.CreatedUtc.ToString("yyyy-MM-ddTHH:mm:ss.fffffffZ")">@blogPost.CommonPart.CreatedUtc.ToLocalTime().ToString("MMMM d, yyyy")</time></span>
                        @if (Model.Tags.Items.Count > 0 && ((IEnumerable<ShowTagViewModel>)Model.Tags.Items[0].Tags).Any()) {
                            <span class="ui--blog-separator">/</span>
                            <span class="ui--meta-categories">@Display(Model.Tags)</span>
                        }
                    </span>
                </span>
            </div>
        </div>
    </div>
    <div class="ui--title ui--animation ui--title-bordered text-left">
        <div class="ui--title-holder">
            <h4 class="ui--title-text"> <strong>@T("Share")</strong> @T("the Post") </h4>
            <div class="ui--title-borders ui--title-border-left"></div>
            <div class="ui--title-borders ui--title-border-right"></div>
        </div>
    </div>

    <div class="ui--sharrre text-center clearfix ui--sharrre-block">
        <div class="ui--sharrre-twitter" data-url="@Request.Url.AbsoluteUri" data-text="@blogPost.TitlePart.Title" data-title="&lt;i class=&#039;fa fa-twitter&#039;&gt;&lt;/i&gt; &lt;span class=&#039;ui--sharrre-link-title&#039;&gt;Tweet&lt;/span&gt;"></div>
        <div class="ui--sharrre-facebook" data-url="@Request.Url.AbsoluteUri" data-text="@blogPost.TitlePart.Title" data-title="&lt;i class=&#039;fa fa-facebook&#039;&gt;&lt;/i&gt; &lt;span class=&#039;ui--sharrre-link-title&#039;&gt;Like&lt;/span&gt;"></div>
        <div class="ui--sharrre-googleplus" data-url="@Request.Url.AbsoluteUri" data-text="@blogPost.TitlePart.Title" data-title="&lt;i class=&#039;fa fa-google-plus-square&#039;&gt;&lt;/i&gt; &lt;span class=&#039;ui--sharrre-link-title&#039;&gt;+1&lt;/span&gt;"></div>
        <div class="ui--sharrre-linkedin" data-url="@Request.Url.AbsoluteUri" data-text="@blogPost.TitlePart.Title" data-title="&lt;i class=&#039;fa fa-linkedin&#039;&gt;&lt;/i&gt; &lt;span class=&#039;ui--sharrre-link-title&#039;&gt;Linkedin&lt;/span&gt;"></div>
        <div class="ui--sharrre-pinterest" data-url="@Request.Url.AbsoluteUri" data-text="@blogPost.TitlePart.Title" data-title="&lt;i class=&#039;fa fa-pinterest&#039;&gt;&lt;/i&gt; &lt;span class=&#039;ui--sharrre-link-title&#039;&gt;Pinterest&lt;/span&gt;"></div>
    </div>

    @Display(Model.Footer)
</div>